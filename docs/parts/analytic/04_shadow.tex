\section{Способы построения теней}

В данной работе будет использоваться метод теневых карт для построения теней на изображении. Использование этого метода основано на его тесной связи с алгоритмом Z-буфера, который был выбран в предыдущей секции.

\subsection*{Метод теневых карт}

Метод теневых карт основывается на построении карты теней методом заполнения матрицы глубин с точки зрения источника света. Глубина пикселя полученная с точки зрения камеры, сравнивается с глубиной, записанной в матрице глубин карты теней. Если глубина в матрице карты теней оказывается меньше,пиксель затеняется~\cite{Shadows}.

Процесс применения этого метода можно разбить на следующие этапы:

\begin{enumerate}
    \item создание теневых карт;
    \item сравнение глубин пикселей;    
    \item применение освещения.
\end{enumerate}

\subsubsection*{Создание теневых карт}

На этом этапе информация о сцене заносится в Z-буфер с точки зрения источника света. Вместо цвета и яркости пикселей в Z-буфер будет сохраняться значение глубины каждого фрагмента изображения. В результате такого заполнения, будет получена текстура, называемая теневой картой. Эта текстура будет использоваться для определения, находится ли фрагмент изображения в тени.

\subsubsection*{Сравнение глубин пикселей} 

На втором этапе информация о сцене заносится в Z-буфер с точки зрения камеры. Для каждого фрагмента изображения координаты преобразуются в координаты теневой карты и значение глубины фрагмента сравниваются  с соответствующим значением в теневой карте. 
Если значение глубины фрагмента больше, чем значение в теневой карте, фрагмент находится в тени~\cite{LightMaps}.

\subsubsection*{Применение освещения} 

На последнем этапе полученная информация о тенях применяется к изображению: те пиксели (фрагменты) которые не находятся в тени, становятся светлее, а остальные - затеняются, в зависимости от интенсивности света.

\subsection*{Преимущества и недостатки}

Метод теневых карт в сочетании с алгоритмом Z-буфера имеет свои преимущества и недостатки. К преимуществам можно отнести:

\begin{itemize}
    \item высокую производительность для динамических сцен;
    \item возможность создания реалистичных теней для сложных объектов.
\end{itemize}

Однако существуют и недостатки:

\begin{itemize}
    \item при низком разрешении теневых карт, могут наблюдаться проблемы с качеством изображения;
    \item ограниченная точность теней для объектов: чем дальше расположен объект от источника света, тем менее точной будет его тень.
\end{itemize}

\subsection*{Вывод}

Метод теневых карт достаточен для достижения целей работы. Поскольку сцена имеет всего один источник света, не придётся производить большое количество вычислений при визуализации сцены. Качество теней должно быть достаточным, так как источник света расположен на условно бесконечном расстоянии от сцены, а следовательно равноудалён от всех объектов. 
